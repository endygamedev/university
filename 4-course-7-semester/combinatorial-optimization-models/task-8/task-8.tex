\documentclass[14pt,fleqn]{extarticle}
\usepackage[T2A,T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{boldline}
\usepackage{makecell}
\usepackage{arydshln}
\usepackage{mathtools}
\usepackage{centernot}
\usepackage{enumitem}
\usepackage{nccmath}
\usepackage{amssymb}
\usepackage[a4paper, total={6.5in, 9.5in}]{geometry}

\graphicspath{ {./images/} }
\setlength{\mathindent}{0pt}
\setlength\parindent{0pt}

\def\at{
	\left.
	\vphantom{\int}
	\right|
}


\begin{document}
	\begin{titlepage}
		\includegraphics[scale=0.12]{logo}
		\begin{center}
			\textbf{МИНОБРНАУКИ РОССИИ}\\
			\vspace{0.2cm}
			\textbf{Федеральное государственное бюджетное образовательное учреждение высшего образования}\\
			\textbf{<<САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ ЭКОНОМИЧЕСКИЙ УНИВЕРСИТЕТ>>}\\
			\vspace{0.6cm}
			Факультет информатики и прикладной математики\\
			Кафедра прикладной математики и экономико-математических методов\\
			\vspace{1cm}
			\textbf{ОТЧЁТ}\\
			по дисциплине:\\
			\textbf{<<Модели комбинаторной оптимизации>>}\\
			на тему:\\
			\textbf{<<Задание №9. Оптимальный план производства: цех (сложные технические карты)>>}\\
		\end{center}
		\vspace{1cm}
		Направление: 01.03.02\\
		Обучающийся: Бронников Егор Игоревич\\
		Группа: ПМ-1901\\
		\vfill
		\begin{center}
			Санкт-Петербург\\
			2022\\
		\end{center}
	\end{titlepage}
	
	\subsection*{Дано}
	\renewcommand\labelitemi{$\vcenter{\hbox{\tiny$\bullet$}}$}
	\begin{itemize}[topsep=0pt,itemsep=-1ex,partopsep=1ex,parsep=1ex]
		\item $H = \{1, \dots, T\}$ -- горизонт планирования
		\item $S$ -- множество машин
		\item $P$ -- множество номенклатуры
		\item $\tau_p$ -- дедлайн для производства номенклатуры $p \in P$
		\item $tech_p$ -- упрощённая техкарта нового типа для номенклатуры $p \in P$
		\item $d_p$ -- спрос на номенклатуру $p\in P$
		\item $price_p$ -- цена за единицу продукции $p \in P$
		\item $next(p, s)$ -- машины-потомки по техкарте $p \in P$ после машины $s \in S$ \textit{(if машина $s$ -- последняя, то $\emptyset$)}
		\item $prev(p, s)$ -- машины-родители по техкарте $p \in P$ до машины $s \in S$ \textit{(if машина $s$ -- первая, то $\emptyset$)}
		\item $first(p)$ -- первые машины по техкарте для $p \in P$
		\item $M = \{m_{p, s, t}\}_{p \in P \; s \in S \; t \in H}$ -- производственные мощности
		\item $BAL_p$ -- множество пар $(S^{-}, S^{+})$ для техкарты номенклатур $p \in P$ для сохранения объёма пула $\; S^{-}, S^{+} \subset machines(tech_p)$
		\item $tc_{p, s}$ -- время обработки номенклатуры $p \in P$ на машине $s$
		\item $T_{p, s} = \{T_{p, s}^{LB}, \dots, T_{p, s}^{UB}\}$ -- множество временных отрезков
		\item $U_{s, t}$ -- множество троек $(p, s, t')$ таких, что если начать производство $p$ в квант времени $t'$ на машине $s$, то машина $s$ будет <<занята>> работой в квант $t$
	\end{itemize}

	\subsection*{Переменные}
	\begin{center}
		$x_{p,s,t} \geq 0$ -- объём производства $p$, если он начал обрабатываться в квант времени $t$ на машине $s$
	\end{center}
	\begin{center}
		$\forall p \in P, \quad \forall i \in M, \quad \forall t \in T$
	\end{center}		
	\begin{align*}
		y_{p,i,t} = 
		\begin{cases}
			1, \quad \textup{if номенклатура } p \textup{ начинает производиться в квант времени } t\\
			\hspace{1cm} \textup{на машине } i\\
			0, \quad \textup{в противном случае}
		\end{cases}
	\end{align*}
	\begin{center}
		$\forall p \in P, \quad \forall i \in M, \quad \forall t \in T$
	\end{center}

	\newpage
	
	\subsection*{Целевая функция}
	
	1) Прибыль:
	\[ \sum_{p = 1}^{n} price_p \sum_{i = 1}^{m} \sum_{t = q_0}^{q_{last}} x_{p,i,t} \longrightarrow \max \]
	
	2) Как можно раньше хотим закончить работы:	
	\[ \sum_{p = 1}^{n} \sum_{i = 1}^{m} \sum_{t = q_0}^{q_{last}} ttc_{p,i} \cdot y_{p,i,t} \longrightarrow \min \]
	
	\textit{Целевая функция}\\
		\[ \sum_{p = 1}^{n} price_p \sum_{i = 1}^{m} \sum_{t = q_0}^{q_{last}} x_{p,i,t} - \sum_{p = 1}^{n} \sum_{i = 1}^{m} \sum_{t = q_0}^{q_{last}} ttc_{p,i} \cdot y_{p,i,t} \longrightarrow \max \]
	
	\subsection*{Ограничения}
	
	1) Не должно быть незавершённого производства (вся номенклатура, которая занимает машинное время, должна быть выпущена к времени выпуска, иначе её не планировать):
	
	\begin{ceqn}
		\begin{align*}
			\smashoperator[r]{\sum_{p = 1}^{n}} \smashoperator[r]{\sum_{i = 1}^{m}} \smashoperator[r]{\sum_{t = q_0}^{q_{last}}} b_{p,i,t,t'} \cdot y_{p,i,t} = 1 \quad \forall t' \in T: t' \geq t
		\end{align*}
	\end{ceqn}
	
	2) Сумма всех работ не машине, проводимых в квант времени, должна быть меньше или равна производительности машины:
	
	\begin{ceqn}
		\begin{align*}
			\smashoperator[r]{\sum_{p = 1}^{n}} \smashoperator[r]{\sum_{i = 1}^{m}} \smashoperator[r]{\sum_{t = q_0}^{q_{last}}} b_{p,i,t,t'} \cdot x_{p,i,t} \leq m_{t,i} \quad \forall t \in T, \; \forall t' \in T: t' \geq t, \; \forall i \in M
		\end{align*}
	\end{ceqn}
	
	3) Время использования машины, должно быть равно времени производства пула номенклатуры на машине:
	
	\begin{ceqn}
		\begin{align*}
			\smashoperator[r]{\sum_{p = 1}^{n}} \smashoperator[r]{\sum_{t = q_0}^{q_{last}}} \smashoperator[r]{\sum_{t' \in T: t' \geq t}} \dfrac{b_{p,i,t,t'} \cdot x_{p,i,t}}{mp_{t,i}} = \smashoperator[r]{\sum_{p = 1}^{n}} \smashoperator[r]{\sum_{t = q_0}^{q_{last}}} y_{p,i,t} \cdot ttc_{p,i} \quad \forall i \in M
		\end{align*}
	\end{ceqn}
	
	\newpage
	
	4) Произвести номенклатуру необходимо до времени завершения производства этой номенклатуры:
	
	\begin{ceqn}
		\begin{align*}
			\smashoperator[r]{\sum_{i = 1}^{m}} \smashoperator[r]{\sum_{t = q_0}^{q_{last}}} ttc_{p,i} \cdot y_{p,i,t} \leq deadline_p \quad \forall p \in P
		\end{align*}
	\end{ceqn}

	5) На каждой машине, в один квант времени может производиться только одна номенклатура:
	
	\begin{ceqn}
		\begin{align*}
			\smashoperator[r]{\sum_{p = 1}^{n}} \smashoperator[r]{\sum_{i = 1}^{m}} y_{p,i,t} \leq 1 \quad \forall t \in T
		\end{align*}
	\end{ceqn}

	6) Производство номенклатуры не превышает спрос:
	
	\begin{ceqn}
		\begin{align*}
			\smashoperator[r]{\sum_{i = 1}^{m}} \smashoperator[r]{\sum_{t = q_0}^{q_{last}}} x_{p,i,t} \leq invoice_p \quad \forall p \in P
		\end{align*}
	\end{ceqn}

	7) Естественные ограничения:
	
	\begin{ceqn}
		\begin{align*}
			x_{p,i,t} \geq 0, \quad \forall p \in P, \quad \forall i \in M, \quad \forall t \in T\\
			y_{p,i,t} \in \{0; 1\}, \quad \forall p \in P, \quad \forall i \in M, \quad \forall t \in T
		\end{align*}
	\end{ceqn}
\end{document}
